/*    Importamos los paquetes de Mapbox   */
import { Injectable, EventEmitter } from '@angular/core';
import * as mapboxgl from 'mapbox-gl';                        /*    construccion de mapa   */
import MapboxGeocoder from '@mapbox/mapbox-gl-geocoder';      /*    pintar lineas en el mapa   */
import { environment } from "../environments/environment";
import { HttpClient } from "@angular/common/http";
import { Socket } from "ngx-socket-io";                        /*    variables   */

@Injectable({
  providedIn: 'root'
})
export class MapCustomService {
  cbAddress: EventEmitter<any> = new EventEmitter<any>();
  mostrar = '';

  mapbox = (mapboxgl as typeof mapboxgl); /*    variables   */
  map: mapboxgl.Map;                       /*    variables   */
  style = 'mapbox://styles/mapbox/streets-v11';   
  lat = 14.2917827;              /*    ubicate en Jutiapa   */
  lng = -89.9047073;
  zoom = 13;
  wayPoints: Array<any> = [];
  markerDriver: any = null;
  markerDriver2: any = null;
  markerDriver3: any = null;

  //Variables para las paradas de buses
  p1: any= null;
  p2: any= null;
  p3: any= null;
  p4: any= null;
  p5: any= null;
  p6: any= null;
  p7: any= null;
  p8: any= null;
  p9: any= null;
  p10: any= null;
  p11: any= null;
  p12: any= null;
  p13: any= null;
  p14: any= null;
  p15: any= null;
  p16: any= null;
  p17: any= null;
  p18: any= null;
  p19: any= null;
  p20: any= null;
  p21: any= null;


  

  rutaTunas: any[] = [
[-89.90835489024862, 14.297993146993027],
[-89.90826484891257,14.297840307048851],
[-89.90815748774295,14.297708594355683],
[-89.9081095131179,14.297627136000498],
[-89.9081023362888,14.29761477238406],
[-89.90806688351893,14.297531025029944],
[-89.9080465795554,14.29751719882686],
[-89.90800580248239,14.29745287359769],
[-89.90799252622605,14.297428981365016],
[-89.90797545675363,14.29739773767231],
[-89.9079346796806,14.29732054735406],
[-89.9079025649589,14.29723153454783],
[-89.90782475159118,14.297079635083328],
[-89.90780219699334,14.297016252543354],
[-89.9077412995765,14.29686872414693],
[-89.9076792744302,14.296705896396768],
[-89.90764455123087,14.296660688227888],
[-89.90757524354241,14.296467941056566],
[-89.9075350104084,14.29638736759121],
[-89.90754171592893,14.296360076572004],
[-89.90750550610845,14.296306794096962],
[-89.90747197849765,14.29624051587898],
[-89.90745320303589,14.296153444466277],
[-89.90744247420028,14.296123554269643],
[-89.90736334903717,14.295946812167157],
[-89.90730568154476,14.295833749131297],
[-89.90727215393157,14.295763572045523],
[-89.90721716864596,14.295606323312498],
[-89.90718632324449,14.295582930929998],
[-89.90718498213789,14.29556603642884],
[-89.90719168765573,14.29557383388915],
[-89.90715547783661,14.295482863485953],
[-89.90709512813807,14.295349006968616],
[-89.90704416615412,14.295228146156882],
[-89.9069958863953,14.29515017140795],
[-89.9069301722602,14.295069597468563],
[-89.90683495384698,14.294965631057343],
[-89.9067343710009,14.294831774229076],
[-89.90660294276853,14.294715461680317],
[-89.90653789919688,14.294651132365471],
[-89.90646749121525,14.294585503451861],
[-89.90644066912394,14.29456016158815],
[-89.90638367218065,14.294517275349728],
[-89.9063206402733,14.294464642230775],
[-89.90622743350454,14.294417857224088],
[-89.90618183595454,14.294387966799157],
[-89.9061556844185,14.294373021585193],
[-89.90609466416775,14.294334722977279],
[-89.90605711323722,14.294300283994673],
[-89.90600279850852,14.294245701448034],
[-89.90594848377985,14.294184620963474],
[-89.90594404792172,14.294171625108792],
[-89.90589979147612,14.294081953723868],
[-89.90588570987978,14.293990332924093],
[-89.90588101601436,14.293963041614807],
[-89.90587498104449,14.293904560226649],
[-89.90591520736018,14.29396758001954],
[-89.9058615631837,14.293892204006804],
[-89.90587899751387,14.293905199871396],
[-89.9053693778374,14.29385321640262],
[-89.90503141949613,14.293814228792545],
[-89.90496570536955,14.293794734985035],
[-89.90491742560039,14.29380383209519],
[-89.90473637649512,14.293785637873988],
[-89.90463311144478,14.293759646126903],
[-89.90454057523147,14.293758346539244],
[-89.90439573594928,14.29373755313947],
[-89.90431661078226,14.293729755613956],
[-89.90410337517076,14.29371286097447],
[-89.90396658250363,14.293685569631151],
[-89.90364337634041,14.293654379520868],
[-89.90320468742173,14.293604752358853],
[-89.90280101496191,14.293583958944305],
[-89.90240807133307,14.293620347417308],
[-89.90197141071256,14.293703521048988],
[-89.90179482316933,14.293556940729353],
[-89.9016809224502,14.293471700801586],
[-89.90155236124245,14.293395203402989],
[-89.9012963665569,14.293266250586479],
[-89.90116548301953,14.29319955937062],
[-89.90090836060408,14.29305202847152],
[-89.90078882122079,14.292984273505445],
[-89.90066928184599,14.29291433287517],
[-89.90053395424812,14.292836742462637],
[-89.90040313758061,14.292762430494559],
[-89.90029560449253,14.292699842021573],
[-89.90015689371576,14.292611323297043],
[-89.90003380524752,14.292531974054485],
[-89.8999187767985,14.29246094045985],
[-89.89977921666387,14.292388772927195],
[-89.89952773288587,14.29225216975118],
[-89.89925575653606,14.292103125019484],
[-89.89913064405856,14.2920492388343],
[-89.89812294115315,14.291471870298324],
[-89.89769110551408,14.29121844802869],
[-89.89742154350613,14.291080690161495],
[-89.89713454714683,14.290872753594101],
[-89.89705408088211,14.290796076939623],
[-89.89701116554096,14.290606334597475],
[-89.89690253606318,14.290329518413625],
[-89.89680061212789,14.290025410116089],
[-89.89679390660584,14.29003710659668],
[-89.89672819248553,14.289853861659925],
[-89.89658201209006,14.289475674832369],
[-89.89647197033902,14.289248832600393],
[-89.89640357400732,14.289079882783572],
[-89.89613140607892,14.28878347723312],
[-89.89598339455733,14.288617514049456],
[-89.89575227563381,14.288337711662091],
[-89.8956610805338,14.288133671427751],
[-89.89554440443298,14.288075188522466],
[-89.89526009028896,14.288028402188344],
[-89.8950495368708,14.28801540598174],
[-89.89484568899096,14.288005009016695],
[-89.89463476346849,14.287991002255454],
[-89.89441884565818,14.287972807564346],
[-89.89399103331017,14.287927320828224],
[-89.89316017422401,14.287902405997134],
[-89.89295230302288,14.287884211298618],
[-89.89231393728056,14.287856919247307],
[-89.89210070165467,14.287845222652992],
[-89.89190087707816,14.287836125301483],
[-89.89146735140699,14.287818580676602],
[-89.89111071264034,14.287799953119686],
[-89.89058915917853,14.287801289619027],
[-89.89025535613912,14.287775558417753],
[-89.88992913955494,14.287731447780535],
[-89.88978310071688,14.28774063749665],
[-89.88958964669602,14.287746151326564],
[-89.88960481953498,14.287722258062766],
[-89.88921601486922,14.287698364796553],
[-89.8889580761604,14.287676309471607],
[-89.8888025543005,14.287663443864291],
[-89.88883669324846,14.287593601980442],
[-89.88896750740687,14.287148717338724],
[-89.88901712752893,14.287078774889325],
[-89.88910057954095,14.286875504538855],
[-89.88917726518508,14.28666567688231],
[-89.88929454909386,14.2863531207474],
[-89.88929453161221,14.286363346068224],
[-89.8891377240489,14.286224090333764],
[-89.88901903630844,14.28613051688613],
[-89.88887687922494,14.286030445236463],
[-89.88880311848229,14.285965463623807],
[-89.88875416816686,14.285929723727111],
[-89.88869381846634,14.285860843185114],
[-89.88865884215184,14.285816048619509],
[-89.88853552486805,14.28564699899552],
[-89.8884838923482,14.285572919829363],
[-89.88841087116325,14.285508326072463],
[-89.88839075459705,14.285466087928368],
[-89.88837533189634,14.28545764029861],
[-89.88841162888832,14.285493556008685],
[-89.88835932581625,14.285448718590981],
[-89.88832177488953,14.285396083349134],
[-89.88822359825984,14.28529028501779],
[-89.88820616389827,14.28526559192492],
[-89.88810423995893,14.285157722068137],
[-89.88804308305843,14.285016373110683],
[-89.88797938059888,14.284935795545069],
[-89.88793914746653,14.284868864158147],
[-89.88792774806295,14.284851319031693],
[-89.88783990572398,14.284805831666457],
[-89.8877713491695,14.284739452680855],
[-89.8876888712424,14.28465692555386],
[-89.88761645160417,14.284577647500015],
[-89.88759834669462,14.28454385684562],
[-89.88754723953404,14.284499194573339],
[-89.8875140293778,14.284475006079402],
[-89.88746777870146,14.284447959086089],
[-89.88740159238353,14.28440159280346],
[-89.88725087896117,14.284314269612274],
[-89.88731387557206,14.284353680967724],
[-89.88722057678913,14.284305769122295],
[-89.88706667366864,14.28420453599618],
[-89.88638814804243,14.28385641358159],
[-89.88587667370211,14.283572492055223],
[-89.88500132868289,14.283132461613029],
[-89.88395043421663,14.282568098962964],
[-89.88313912357181,14.282126095756247],
[-89.88237465464871,14.281803861356375],
[-89.88117143801043,14.281296611630562],
[-89.88048469007555,14.281092267186027],
[-89.87952578808961,14.280663540984225],
[-89.8788482932226,14.280416984004887],
[-89.87808414367097,14.280107416297566],
[-89.87750223504653,14.27988009616379],
[-89.88903787946518,14.287024785141096],
[-89.88895654206885,14.287224157760821],
[-89.88884649735617,14.287493078688996],
[-89.88880369012811,14.287656482262133],
[-89.88874079083033,14.287949033758123],
[-89.88869489099986,14.28813193128565],
[-89.8887096431484,14.288162472351846],
[-89.88883436585867,14.288167021020914],
[-89.88902841072574,14.288190267052851],
[-89.88945013302228,14.288218699367759],
[-89.88946930443046,14.288215420831776],
[-89.88981366990114,14.288239750490932],
[-89.88978015736198,14.288232442228683],
[-89.89011960405958,14.288248834906833],
[-89.89045110919747,14.288265899478178],
[-89.89083673707788,14.288269942619605],
[-89.89107343334052,14.288284601080305],
[-89.89171676546006,14.288318051054649],
[-89.89216486785125,14.288324075541015],
[-89.892558234378,14.288356614208748],
[-89.89278985369155,14.288359607582152],
[-89.89309107919267,14.288377386247346],
[-89.89353447785277,14.288420856042196],
[-89.8936705144263,14.288451867717347],
[-89.89394127982466,14.288486240389945],
[-89.89388748822796,14.28845752157632],
[-89.8939258310443,14.288468450017621],
[-89.89395976051517,14.288639359849256],
[-89.89388197645927,14.288926575021835],
[-89.89383202190447,14.289263181784184],
[-89.89371443220551,14.289774125989606],
[-89.89369167290896,14.28986418438033],
[-89.89386039702521,14.289959135363521],
[-89.89413161197605,14.290076762545423],
[-89.89412781875996,14.29008227631805],
[-89.89441095301807,14.290203251514615],
[-89.89469161832652,14.29033541964132],
[-89.89509143495407,14.290486259829233],
[-89.89548530897272,14.290669962927092],
[-89.8954208242991,14.290649745812896],
[-89.89586198651551,14.290811093954542],
[-89.89623812713907,14.290979003722933],
[-89.89667349388407,14.291195090473035],
[-89.89700729691221,14.29136234068619],
[-89.89753411676385,14.29167179979978],
[-89.89819736127524,14.292069897438516],
[-89.89852547446748,14.292244498626008],
[-89.89891647726289,14.292439203715878],
[-89.89930305620847,14.292672978289163],
[-89.89943961199536,14.29274465649665],
[-89.89950978649311,14.292786928248699],
[-89.90015717708242,14.293178505160311],
[-89.90078554834035,14.293496874348229],
[-89.90139578185418,14.293849027005699],
[-89.90152359429908,14.29395153098418],
[-89.90177204995332,14.293819202679995],
[-89.9018920472065,14.293742536447443],
[-89.90202670637787,14.293705778558817],
[-89.90222403757672,14.293802517697431],
[-89.90233727199121,14.29383806369553],
[-89.90273730489247,14.293939616732457],
[-89.90329469585926,14.294075522798519],
[-89.90397329538891,14.294234578856296],
[-89.90462989961549,14.29429948748871],
[-89.9050161682334,14.294322956842949],
[-89.9051522235263,14.29432757076434],
[-89.90563227364974,14.294338389086915],
[-89.9059903089568,14.294345262179759],
[-89.90607643090586,14.294340625756004],
[-89.90613544038946,14.294366898822705],
[-89.90625505420759,14.294424081369035],
[-89.90628695122578,14.294468900111386],
[-89.90634939165398,14.294480718558566],


  ];
  rutaMetroPlaza: any[] = [
    [-89.91184392492988,14.292574965430545],
    [-89.9117983273799,14.29257756461904],
    [-89.91166939803651,14.292605387583867],
    [-89.9115656468864,14.292626151238979],
    [-89.91154647547825,14.292642543596925],
    [-89.91160499646601,14.292838721399484],
    [-89.91169310585644,14.293292880079228],
    [-89.91140212330116,14.293345677509642],
    [-89.91070610243307,14.293481272067433],
    [-89.9102528091419,14.293548850686266],
    [-89.90996213402168,14.293791316751395],
    [-89.90996213402168,14.293791316751395],
    [-89.90855812055858,14.294011130908116],
    [-89.90730001758821,14.294032469918216],
    [-89.90723794964971,14.294067681644636],
    [-89.90606347680664,14.29391195740124],
    [-89.90477739820749,14.293784378929798],
    [-89.9033835252191,14.293604525848819],
    [-89.90239777834135,14.293606974706654],
    [-89.90196228234468,14.293702682088279],
    [-89.90184086271196,14.293617876722777],
    [-89.90187841363549,14.29366791086404],
    [-89.9017637946443,14.293536344457648],
    [-89.90171216212444,14.293494107820907],
    [-89.90166254124121,14.293449271995605],
    [-89.90159347436398,14.293417432057847],
    [-89.90146003447501,14.293348553809743],
    [-89.90139566143957,14.29331736365068],
    [-89.90126691541604,14.293246535986375],
    [-89.90119650743442,14.293213396429344],
    [-89.90112542890058,14.293177657685918],
    [-89.90106767607361,14.293148055650592],
    [-89.90094362391552,14.293075928341596],
    [-89.90087676560901,14.293043176177717],
    [-89.90080805987361,14.292994554935417],
    [-89.90068379514486,14.29293425184852],
    [-89.90050118554134,14.292819332345845],
    [-89.90031703664756,14.292710506837093],
    [-89.90028082682845,14.29268386516932],
    [-89.9001949961427,14.292631881417549],
    [-89.90012291581166,14.292591983026902],
    [-89.89993442761154,14.292476803083016],
    [-89.8997310056631,14.292360509365981],
    [-89.89956336761163,14.292265638874813],
    [-89.8994916185256,14.29222989998077],
    [-89.89949570268817,14.292230881296604],
    [-89.8993622627992,14.29216330228174],
    [-89.89929453702642,14.292129512766683],
    [-89.8992314129237,14.292102200890671],
    [-89.89917374543398,14.292067761567859],
    [-89.89909230166033,14.292039398896376],
    [-89.8990212231265,14.292017305740323],
    [-89.89894746238384,14.291969220628477],
    [-89.89867835300358,14.2918197852806],
    [-89.89843476334684,14.291666789333648],
    [-89.89818291565197,14.291522419176728],
    [-89.89782404025023,14.291313609419],
    [-89.8976966067724,14.291231647133044],
    [-89.89741356088977,14.2910672063639],
    [-89.89720738980408,14.29096890180043],
    [-89.89706557928538,14.290795109052253],
    [-89.89701144825057,14.29062244140367],
    [-89.89697934265988,14.290468292829999],
    [-89.89686769740054,14.290225683465199],
    [-89.89680554376052,14.290031571250722],
    [-89.89672233088871,14.289833587582532],
    [-89.89656942811679,14.289462297659231],
    [-89.89648482272794,14.289273502243175],
    [-89.8964110618782,14.289082491217865],
    [-89.89612944788493,14.288789530919889],
    [-89.89588021957871,14.288486813331843],
    [-89.8957410975765,14.288322241796589],
    [-89.89572833876923,14.288249602534938],
    [-89.89573312332197,14.288235692886415],
    [-89.89572674391833,14.288197054969332],
    [-89.89567092413655,14.28815378049433],
    [-89.89554297356987,14.288067844089994],
    [-89.89540483980016,14.288038602631238],
    [-89.89526070633558,14.288035790954593],
    [-89.89505149404734,14.288018246077392],
    [-89.89491208748534,14.288007802931025],
    [-89.89462309649805,14.287987169942578],
    [-89.89482252624221,14.287993649615323],
    [-89.89442782076169,14.287967421299786],
    [-89.89403537073872,14.287939007287752],
    [-89.89361585520038,14.287917150353467],
    [-89.89365008091553,14.28793089526987],
    [-89.89365741992934,14.287703148887188],
    [-89.89366121314546,14.287306152713136],
    [-89.89367716165455,14.287173237701381],
    [-89.89366121314546,14.28703568603676],
    [-89.89383345704357,14.287072778628769],
    [-89.89396582966897,14.287099052544399],
    [-89.8939706142217,14.287061959956729],
    [-89.8939844401242,14.286896801473526],
    [-89.89399117334494,14.286711265327659],
    [-89.8940941192316,14.286250889286736],
    [-89.89422595706954,14.286008246838758],
    [-89.89435195029132,14.285900059583161],
    [-89.89470200507192,14.285789112875879],
    [-89.89486467986458,14.285719563864097],
    [-89.89475199463868,14.28565617060358],
    [-89.89460785242704,14.285395180082523],
    [-89.89463061172363,14.285340041201323],
    [-89.89478099550048,14.284847525273282],
    [-89.89494031057649,14.284524042856718],
    [-89.89506247239183,14.28428129355312],
    [-89.89547597114131,14.283519939729866],
    [-89.89576958157075,14.283014728167142],
    [-89.89601102266188,14.282438578886344],
    [-89.89628034100464,14.28201584156471],
    [-89.8971719150942,14.282384321000954],
    [-89.89786149250278,14.282736293651702],
    [-89.89828633270547,14.28292009199642],
    [-89.89927839042751,14.28360453912878],
    [-89.89963874595658,14.284038301307968],
    [-89.90001561372111,14.28432880869883],
    [-89.90016625671021,14.284472055401613],
    [-89.90012736468226,14.284634510476206],
    [-89.90006523875714,14.284811334186891],
    [-89.89988237877134,14.285242405710834],
    [-89.89947116699906,14.286116879454323],
    [-89.89909563852879,14.286627830829886],
    [-89.8981814734309,14.2872747891564],
    [-89.8980962247565,14.287394913693136],
    [-89.89796863668042,14.287728746273329],
    [-89.89789409672063,14.28806392916703],
    [-89.89778949053198,14.28827186832533],
    [-89.897533339578,14.288374538213167],
    [-89.89709345730614,14.288516196590797],
    [-89.89695440316315,14.288602567462474],
    [-89.89686520810187,14.288665351425673],
    [-89.89679264238556,14.288699352722277],
    [-89.89672565864738,14.288666896939263],
    [-89.89658067630384,14.288587076434608],
    [-89.89643279529821,14.288528021954692],
    [-89.89625821151816,14.288442139081711],
    [-89.89611429593377,14.288309077450636],
    [-89.89580648970843,14.288165344412405],
    [-89.89576980813756,14.288162253378315],
    [-89.8956806881271,14.288146179255476],
    [-89.89524365804212,14.288046195183972],
    [-89.89316679396319,14.287898989518434],
    [-89.89276407626508,14.287879738417267],
    [-89.89202712627365,14.287841172078645],
    [-89.89142561123933,14.287814570530886],
    [-89.89125336734124,14.28779293325764],
    [-89.89120045430849,14.288288639673514],
    [-89.89207215105586,14.288335963896264],
    [-89.8924616131278,14.288354756249221],
    [-89.89271027920752,14.288362132472026],
    [-89.89312392462674,14.288384914238508],
    [-89.89339552858014,14.288398788148093],
    [-89.8938671106817,14.28846565186458],
    [-89.893997976637,14.28851160029488],
    [-89.89391262927484,14.288842428715977],
    [-89.8938671106817,14.289086873847896],
    [-89.89375521080461,14.289539004758286],
    [-89.8937077956034,14.289847776556236],
    [-89.89370969221959,14.28986615582211],
    [-89.89457619562143,14.290250489750168],
    [-89.89486395897131,14.290398961062557],
    [-89.89519357216935,14.290528210501325],
    [-89.89633650292363,14.291022829082221],
    [-89.89687441161509,14.291276194379964],
    [-89.89720692881426,14.291484586398795],
    [-89.89750468716937,14.291623595432412],
    [-89.89771104237018,14.291744274703595],
    [-89.89811343793991,14.291996171506213],
    [-89.89815769439745,14.292027361847802],
    [-89.89832533246359,14.292117034054888],
    [-89.89878942633756,14.292371556862557],
    [-89.89938889941864,14.292724793356971],
    [-89.90014681145797,14.293157990491625],
    [-89.90082019826387,14.293519574870475],
    [-89.90130485012317,14.293807177757147],
    [-89.90145773602612,14.293905946357771],
    [-89.90152479125273,14.29395792981399],
    [-89.9016575605895,14.293879954624618],
    [-89.90175948452479,14.29381237610527],
    [-89.90181044649243,14.293764291377228],
    [-89.90194039688166,14.293724637245614],
    [-89.90211876376841,14.293660957443567]
  ]




  constructor(private httpClient: HttpClient, private socket: Socket) {
    this.mapbox.accessToken = environment.mapPk;   /*  llamamos la llave del mapra  */
  }

  buildMap(): Promise<any> {
    
      /* contruimos el mapa con las variables que declaramos   */
    return new Promise((resolve, reject) => {
      try {
        this.map = new mapboxgl.Map({
          container: 'map',            /*    se  utiliza en el index   */
          style: this.style,            /*    el estilo   */
          zoom: this.zoom,              /*    el zoom   */
          center: [this.lng, this.lat]     /*    centrar el mapa entre las cordenadas principales   */
        });







        /** TODO: Aqui construimos el input buscador de direcciones*/
        const geocoder = new MapboxGeocoder({   /*acceso al mapa*/
          accessToken: mapboxgl.accessToken,     /*acceso a la llave*/
          mapboxgl
        });

        geocoder.on('result', ($event) => {
          const { result } = $event;
          geocoder.clear();
          console.log('*********', result)
          this.cbAddress.emit(result);
        })

        resolve({
          map: this.map,
          geocoder
        });

      } catch (e) {
        reject(e);
      }
    });
  }

  loadCoords(coords, ruta): void {

    /*  const url = [
       `https://api.mapbox.com/directions/v5/mapbox/driving/`,
       `${coords[0][0]},${coords[0][1]};${coords[1][0]},${coords[1][1]}`,
       `?steps=true&geometries=geojson&access_token=${environment.mapPk}`,
     ].join('');
     //`,-89.8939141,14.2876664;-89.8829917,14.2811682`,
     this.httpClient.get(url).subscribe((res: any) => {
  */ //const data = res.routes[0];

    // declaramos  2 constates para las 2 rutas
    const route1 = this.rutaTunas;   //se guardan en otras variables matrices
    const route2 = this.rutaMetroPlaza;
    const route = ruta === 'TUNAS' ? route1 : route2;//nos redirige

    console.log('RUTA', route);
    console.log('RUTA T', this.rutaTunas);


    this.map.addSource('route', {  // en el mapa que se agreque la rutaa que reseibe
      type: 'geojson',
      data: {
        type: 'Feature',
        properties: {},
        geometry: {
          type: 'LineString',
          coordinates: route
        }
      }
    });

    //pinta la ruta en el mapa
    this.map.addLayer({
      id: 'route',
      type: 'line',
      source: 'route',
      layout: {
        'line-join': 'round',
        'line-cap': 'round'
      },
      paint: {
        'line-color': 'red',
        'line-width': 8
      }
    });
// que inicie en un punto y termine en otro
    this.wayPoints = route;//marcar cada punto en el mapa
    this.map.fitBounds([route[0], route[route.length - 1]], {
      padding: 70
    });

    this.socket.emit('find-driver', { points: route });

    //});


  }

  addMarkerCustom(coords, image): void { // resibimos 2 variables el icono y la cordenada

    const el = document.createElement('div');
    el.className = image;
    if (image === 'marker') { // segun la imagen que se resiva cambia el icono marker
      if (!this.markerDriver) {
        this.markerDriver = new mapboxgl.Marker(el);
      } else {      
        this.markerDriver
          .setLngLat(coords) // resibe las cordenadas nuevas  
          .addTo(this.map);  // pinta las cordenadas resibidas
      }


    } else if (image === 'bus') {

      if (!this.markerDriver2) {
        this.markerDriver2 = new mapboxgl.Marker(el);
      } else {
        
        this.markerDriver2
          .setLngLat(coords)
          .addTo(this.map);
      }

    } else if (image === 'bus2') {

      if (!this.markerDriver3) {
        this.markerDriver3 = new mapboxgl.Marker(el);
      } else {

        this.markerDriver3
          .setLngLat(coords)
          .addTo(this.map);
      }


    }

  }

  cargarParadasTunas(){
     console.log('Paradas');
  
    const el1 = document.createElement('div');
    const el2 = document.createElement('div');
    const el3 = document.createElement('div');
    const el4 = document.createElement('div');
    const el5 = document.createElement('div');
    const el6 = document.createElement('div');
    const el7 = document.createElement('div');
    const el8 = document.createElement('div');
    const el9 = document.createElement('div');
    const el10 = document.createElement('div');
    const el11 = document.createElement('div');
    const el12 = document.createElement('div');
    const el13 = document.createElement('div');
    const el14 = document.createElement('div');
    const el15 = document.createElement('div');
    const el16 = document.createElement('div');
    const el17 = document.createElement('div');
    const el18 = document.createElement('div');
    

    

    el1.className = 'montana';
    el2.className = 'sarita';
    el3.className = 'veterinaria';
    el4.className = 'radio';
    el5.className = 'pmt';
    el6.className = 'yes';
    el7.className = 'upana';
    el8.className = 'parada';
    el9.className = 'itb';
    el10.className = 'parada';
    el11.className = 'parada';
    el12.className = 'parada';
    el13.className = 'liceo';
    el14.className = 'way';
    el15.className = 'taxi';
    el16.className = 'mariano';
    el17.className = 'wayo';
    el18.className = 'ecco';


      this.p1 = new mapboxgl.Marker(el1);
      this.p2 = new mapboxgl.Marker(el2);
      this.p3 = new mapboxgl.Marker(el3);
      this.p4 = new mapboxgl.Marker(el4);
      this.p5 = new mapboxgl.Marker(el5);
      this.p6 = new mapboxgl.Marker(el6);
      this.p7 = new mapboxgl.Marker(el7);
      this.p8 = new mapboxgl.Marker(el8);
      this.p9 = new mapboxgl.Marker(el9);
      this.p10 = new mapboxgl.Marker(el10);
      this.p11 = new mapboxgl.Marker(el11);
      this.p12 = new mapboxgl.Marker(el12);
      this.p13 = new mapboxgl.Marker(el13);
      this.p14 = new mapboxgl.Marker(el14);
      this.p15 = new mapboxgl.Marker(el15);
      this.p16 = new mapboxgl.Marker(el16);
      this.p17 = new mapboxgl.Marker(el17);
      this.p18 = new mapboxgl.Marker(el18);
      
      

     
     console.log('Paradas pintar');

      this.p1
        .setLngLat([-89.90816315542443, 14.297704865118183])
        .addTo(this.map);
      this.p2
        .setLngLat([-89.90043707226602, 14.29276336275319])
        .addTo(this.map);
      this.p3
        .setLngLat([-89.89946274337176, 14.292197984266666])
        .addTo(this.map);
      this.p4
        .setLngLat([-89.89692886626648, 14.290323487081066])
        .addTo(this.map);
        this.p5
        .setLngLat([-89.89566134632814, 14.288105718765845])
        .addTo(this.map);
        this.p6
        .setLngLat([-89.8902802960199, 14.288141489542763])
        .addTo(this.map);
        this.p7
        .setLngLat([-89.88990621315313, 14.28825309987068])
        .addTo(this.map);
        this.p8
        .setLngLat([-89.88879829719023,  14.287435862702772] )
        .addTo(this.map);
        this.p9
        .setLngLat([-89.88905771664334,14.286826155360018])
        .addTo(this.map);
        this.p10
        .setLngLat([-89.88818506078351,14.285285560245086])
        .addTo(this.map);
        this.p11
        .setLngLat([-89.87813806759361,14.280216487459652])
        .addTo(this.map);
        this.p12
        .setLngLat([-89.89388902832849,14.288514273680995])
        .addTo(this.map);
        this.p13
        .setLngLat([-89.89463132668864,14.29038066962475])
        .addTo(this.map);
        this.p14
        .setLngLat([-889.8966075112047,14.291233892208709])
        .addTo(this.map);
        this.p15
        .setLngLat([ -89.89802863395883,14.292003387603126])
        .addTo(this.map);
        this.p16
        .setLngLat([ -89.89737229737446,14.282714713702497] )
        .addTo(this.map);
        this.p17
        .setLngLat([-889.8966075112047,14.291233892208709])
        .addTo(this.map);
        this.p18
        .setLngLat([-89.90618084803087,14.293895284757424])
        .addTo(this.map);
  }

  
}